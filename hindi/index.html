<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Font Awesome & CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../style.css"> <!-- Go up one level to main folder -->

    <!-- Favicon -->
    <link rel="icon" href="../images/logo.png" type="image/png"> <!-- Go up for images -->

    <!-- XLSX Library -->
    <script type="text/javascript" src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script>

    <title>Moviezoon - Hindi</title>
</head>
<body>

    <!-- Navigation Bar -->
    <nav class="navbar">
        <a href="../index.html" style="text-decoration: none;"> <!-- Go to main index -->
            <div class="logo" title="Moviezoon">M</div>
        </a>

        <div class="search-bar">
            <input id="search-input" type="text" placeholder="Search...">
            <button onclick="searchMovies()">
                <div class="search-icon">
                    <i class="fas fa-search"></i>
                </div>
            </button>
        </div>

        <!-- Language Dropdown -->
        <div class="language-dropdown">
            <button class="btn" onclick="window.location.href='../urdu/'">Urdu</button>
            <button class="btn" onclick="window.location.href='../punjabi/'">Punjabi</button>
            <button class="btn" onclick="window.location.href='../english/'">English</button>
            <button class="btn" onclick="window.location.href='../hindi/'">Hindi</button>
            <button class="btn" onclick="window.location.href='../h-dubbed/'">H-Dubbed</button>
        </div>

        <!-- Mobile Dropdown -->
        <div class="mobile-language-dropdown">
            <button class="btn dropdown-toggle" onclick="toggleDropdown()">Language</button>
            <div class="dropdown-content" id="dropdown-content">
                <a href="../urdu/">Urdu</a>
                <a href="../punjabi/">Punjabi</a>
                <a href="../english/">English</a>
                <a href="../hindi/">Hindi</a>
                <a href="../h-dubbed/">H-Dubbed</a>
            </div>
        </div>

        <div class="profile" onclick="goToProfile()">
            <img src="../images/pf-pic.jpg" alt="Profile Picture"> <!-- Profile image path corrected -->
        </div>
    </nav>

    <!-- Sidebar -->
    <div class="sidebar">
        <a href="../playlist.html" title="Playlist" class="playlist-img"></a>
        <a href="../Watched.html" title="Just Watched" class="justwatched-img"></a>
        <a href="../Liked.html" title="Liked" class="liked-img"></a>
    </div>

    <!-- Movie Gallery Section -->
    <div id="excel_data" class="gallery"></div>

    <div>
        <h5>Moviezooooooooooooooon</h5>
    </div>

    <!-- JavaScript Section -->
    <script>
        // Function to shuffle the array in random order
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Function to load and process the Excel file automatically
        function loadExcelFile(filePath) {
            fetch(`../${filePath}`)  // Load from main folder
                .then(response => response.arrayBuffer())
                .then(data => {
                    const workbook = XLSX.read(data, { type: 'array' });
                    const sheet_name = workbook.SheetNames[0];
                    const sheet_data = XLSX.utils.sheet_to_json(workbook.Sheets[sheet_name], { defval: '' });

                    if (sheet_data.length > 0) {
                        const filteredData = sheet_data.filter(row => row['language'] && row['language'].toLowerCase() === 'hindi');
                        const shuffledData = shuffleArray(filteredData);

                        let output = '';
                        shuffledData.forEach((row, index) => {
                            const imagePath = row['image_url'] || 'https://via.placeholder.com/300';
                            const title = row['title'] || `Untitled (Row ${index + 1})`;

                            output += `
                                <div class="frame" onclick="window.location.href='video.html?vpcode=${row['vpcode']}'">
                                    <img src="${imagePath}" alt="${title}">
                                    <div class="title">${title}</div>
                                </div>`;
                        });
                        document.getElementById('excel_data').innerHTML = output;
                    } else {
                        document.getElementById('excel_data').innerHTML = 
                        '<div class="alert alert-warning">No data found in the Excel file</div>';
                    }
                })
                .catch(error => {
                    document.getElementById('excel_data').innerHTML = 
                    `<div class="alert alert-danger">Error loading file: ${error.message}</div>`;
                });
        }

        // Load Excel file on page load
        window.onload = () => {
            loadExcelFile('videos.xlsx');
        };

        // Dropdown Toggle
        function toggleDropdown() {
            const dropdown = document.getElementById('dropdown-content');
            dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
        }

        // Search Movie Function
        function searchMovies() {
            const searchInput = document.getElementById('search-input').value.trim();
            if (searchInput) {
                window.location.href = `../search.html?query=${encodeURIComponent(searchInput)}`;
            } else {
                alert("Please enter a search term!");
            }
        }
    </script>

</body>
</html>
